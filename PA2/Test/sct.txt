This is a self-contained test.